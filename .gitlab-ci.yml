before_script:
  - echo
  - npm install

run-test:
  script:
    - npm run lint
    - npm test
    - npm run test-upgrade

aws-integration-test:
  image: gitlab-registry.nordstrom.com/cicd/images/incubator/artillery:unstable
  script:
    # Authenticate with AWS
    - creds-helper -aws

    # Create test project
    - mkdir slsart-test
    - cd slsart-test
    - bin/serverless-artillery configure

    # Check the `script` and `update` commands
    - bin/serverless-artillery script
    - bin/serverless-artillery upgrade

    # Validate minimal use case is working
    - bin/serverless-artillery deploy --stage test
    - bin/serverless-artillery invoke --stage test
    - bin/serverless-artillery remove --stage test

    # Clean up
    - cd ..
    - rm -rf slsart-test
